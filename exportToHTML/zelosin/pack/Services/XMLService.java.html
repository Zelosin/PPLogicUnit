<html>
<head>
<title>XMLService.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
XMLService.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">zelosin.pack.Services</span><span class="s0">;</span>

<span class="s0">import </span><span class="s1">org.jsoup.Jsoup</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.jsoup.nodes.Document</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.jsoup.nodes.Element</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">org.jsoup.parser.Parser</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">zelosin.pack.Configurations.Form.SheetConfigurations</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">zelosin.pack.Configurations.Query.QueryConfigurations</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">zelosin.pack.Configurations.Query.QueryTypeAction</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">zelosin.pack.Data.AJAXConfiguration</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">zelosin.pack.Data.DepartmentMember</span><span class="s0">;</span>

<span class="s0">import </span><span class="s1">java.io.File</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.io.FileInputStream</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.io.FileNotFoundException</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.io.IOException</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.HashMap</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.Map</span><span class="s0">;</span>

<span class="s0">public class </span><span class="s1">XMLService {</span>

    <span class="s0">private static </span><span class="s1">FileInputStream mQueryFileStream</span><span class="s0">;</span>
    <span class="s0">private static </span><span class="s1">Document mQueryFileDocument</span><span class="s0">;</span>

    <span class="s0">public static void </span><span class="s1">secureFilesOpenCall(){</span>
        <span class="s0">try </span><span class="s1">{</span>
            <span class="s1">openAllFileStream()</span><span class="s0">;</span>
            <span class="s1">getFileDocument(mQueryFileStream)</span><span class="s0">;</span>
            <span class="s1">mQueryFileStream.close()</span><span class="s0">;</span>
            <span class="s1">parseQueryFile()</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(IOException e) {</span>
            <span class="s1">e.printStackTrace()</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">private static void </span><span class="s1">openAllFileStream() </span><span class="s0">throws </span><span class="s1">FileNotFoundException {</span>
        <span class="s1">mQueryFileStream = </span><span class="s0">new </span><span class="s1">FileInputStream(</span><span class="s0">new </span><span class="s1">File(</span><span class="s2">&quot;QueryConfiguration.xml&quot;</span><span class="s1">))</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private static void </span><span class="s1">getFileDocument(FileInputStream pFileStream) </span><span class="s0">throws </span><span class="s1">IOException {</span>
         <span class="s1">mQueryFileDocument = Jsoup.parse(pFileStream</span><span class="s0">, null, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">Parser.xmlParser())</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public static </span><span class="s1">Document getmQueryFileDocument() {</span>
        <span class="s0">return </span><span class="s1">mQueryFileDocument</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseQueryFile(){</span>
        <span class="s1">parseGeneralPart(mQueryFileDocument)</span><span class="s0">;</span>
        <span class="s1">parseForPersons(mQueryFileDocument)</span><span class="s0">;</span>
        <span class="s1">parseAJAXPart(mQueryFileDocument)</span><span class="s0">;</span>
        <span class="s1">parseForExcelSheets(mQueryFileDocument)</span><span class="s0">;</span>
        <span class="s1">parseQueryConfigurationSection(mQueryFileDocument)</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseAJAXPart(Document pParsingDocument){</span>
        <span class="s0">for</span><span class="s1">(Element mAJAXLElement : pParsingDocument.selectFirst(</span><span class="s2">&quot;resource_ajax_url_list&quot;</span><span class="s1">).children())</span>
            <span class="s0">new </span><span class="s1">AJAXConfiguration(mAJAXLElement.attr(</span><span class="s2">&quot;assign_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;url_part&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">QueryType.Resource)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element mAJAXLElement : pParsingDocument.selectFirst(</span><span class="s2">&quot;document_ajax_url_list&quot;</span><span class="s1">).children())</span>
            <span class="s0">new </span><span class="s1">AJAXConfiguration(mAJAXLElement.attr(</span><span class="s2">&quot;assign_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;url_part&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">QueryType.Document)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element mAJAXLElement : pParsingDocument.selectFirst(</span><span class="s2">&quot;nir_ajax_url_list&quot;</span><span class="s1">).children())</span>
            <span class="s0">new </span><span class="s1">AJAXConfiguration(mAJAXLElement.attr(</span><span class="s2">&quot;assign_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;url_part&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">QueryType.NIR)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element mAJAXLElement : pParsingDocument.selectFirst(</span><span class="s2">&quot;rid_ajax_url_list&quot;</span><span class="s1">).children())</span>
            <span class="s0">new </span><span class="s1">AJAXConfiguration(mAJAXLElement.attr(</span><span class="s2">&quot;assign_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;url_part&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mAJAXLElement.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">QueryType.RID)</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseGeneralPart(Document pParsingDocument) {</span>
        <span class="s1">Element mGeneralListElement = pParsingDocument.selectFirst(</span><span class="s2">&quot;general&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element mGeneralElement : mGeneralListElement.children())</span>
            <span class="s0">switch </span><span class="s1">(mGeneralElement.tagName()){</span>
                <span class="s0">case</span><span class="s1">(</span><span class="s2">&quot;department_link&quot;</span><span class="s1">): {</span>
                    <span class="s1">QueryConfigurations.mSessionDepartmentLink = mGeneralElement.attr(</span><span class="s2">&quot;link&quot;</span><span class="s1">)</span><span class="s0">;</span>
                    <span class="s0">break;</span>
                <span class="s1">}</span>
                <span class="s0">case</span><span class="s1">(</span><span class="s2">&quot;list_of_study_groups&quot;</span><span class="s1">): {</span>
                    <span class="s1">QueryConfigurations.mGroupListLink = mGeneralElement.attr(</span><span class="s2">&quot;link&quot;</span><span class="s1">)</span><span class="s0">;</span>
                    <span class="s0">break;</span>
                <span class="s1">}</span>
                <span class="s0">case</span><span class="s1">(</span><span class="s2">&quot;profile_service&quot;</span><span class="s1">): {</span>
                    <span class="s1">QueryConfigurations.mProfileService = mGeneralElement.attr(</span><span class="s2">&quot;link&quot;</span><span class="s1">)</span><span class="s0">;</span>
                    <span class="s0">break;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseForPersons(Document pParsingDocument) {</span>
        <span class="s1">Element mPersonListElement = pParsingDocument.selectFirst(</span><span class="s2">&quot;person_query_list&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element tPersonElement : mPersonListElement.children()){</span>
            <span class="s1">String tGroup = tPersonElement.attr(</span><span class="s2">&quot;group&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s0">if</span><span class="s1">(tGroup != </span><span class="s0">null</span><span class="s1">){</span>
                <span class="s0">new </span><span class="s1">DepartmentMember(tPersonElement.attr(</span><span class="s2">&quot;full_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">tGroup)</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">else</span>
                <span class="s0">new </span><span class="s1">DepartmentMember(tPersonElement.attr(</span><span class="s2">&quot;full_name&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseForExcelSheets(Document pParsingDocument) {</span>
        <span class="s1">Element mSheetList = pParsingDocument.selectFirst(</span><span class="s2">&quot;excel_configurations_list&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s0">for</span><span class="s1">(Element tSheetElement : mSheetList.children()){</span>
            <span class="s1">SheetConfigurations tCurrentSheet = </span><span class="s0">new </span><span class="s1">SheetConfigurations(tSheetElement.attr(</span><span class="s2">&quot;name&quot;</span><span class="s1">)</span><span class="s0">, false</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s0">for</span><span class="s1">(Element tTableConfig : tSheetElement.children())</span>
                <span class="s1">tCurrentSheet.</span><span class="s0">new </span><span class="s1">TableFormConfigurations(</span>
                        <span class="s1">tTableConfig.attr(</span><span class="s2">&quot;display_text&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">QueryType.valueOf(tTableConfig.attr(</span><span class="s2">&quot;query_type&quot;</span><span class="s1">))</span><span class="s0">,</span>
                        <span class="s1">tTableConfig.attr(</span><span class="s2">&quot;section_name&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">tTableConfig.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">Integer.valueOf(tTableConfig.attr(</span><span class="s2">&quot;column&quot;</span><span class="s1">))</span><span class="s0">,</span>
                        <span class="s1">Integer.valueOf(tTableConfig.attr(</span><span class="s2">&quot;row&quot;</span><span class="s1">))</span><span class="s0">,</span>
                        <span class="s1">Integer.valueOf(tTableConfig.attr(</span><span class="s2">&quot;column_width&quot;</span><span class="s1">))</span>
                <span class="s1">)</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">private static void </span><span class="s1">parseQuerySection(QueryType pQueryType</span><span class="s0">, </span><span class="s1">String pListName</span><span class="s0">, </span><span class="s1">Element pQueryTypeListElement){</span>
        <span class="s0">for</span><span class="s1">(Element mQueryTypeElement : pQueryTypeListElement.selectFirst(pListName).children()){</span>
            <span class="s0">new </span><span class="s1">QueryConfigurations.QueryConfiguration(</span>
                    <span class="s1">pQueryType</span><span class="s0">,  </span><span class="s1">mQueryTypeElement.attr(</span><span class="s2">&quot;assign_name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">mQueryTypeElement.attr(</span><span class="s2">&quot;variable&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">Boolean.parseBoolean(mQueryTypeElement.attr(</span><span class="s2">&quot;able&quot;</span><span class="s1">)))</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">public static void </span><span class="s1">parseQueryConfigurationSection(Document pParsingDocument){</span>
        <span class="s1">Element mQueryTypeListElement = pParsingDocument.selectFirst(</span><span class="s2">&quot;query_configurations_list&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">Map&lt;QueryType</span><span class="s0">, </span><span class="s1">String&gt; tQueryTypeMap = </span><span class="s0">new </span><span class="s1">HashMap&lt;&gt;(){{</span>
            <span class="s1">put(QueryType.Resource</span><span class="s0">, </span><span class="s2">&quot;resource_query&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">put(QueryType.Document</span><span class="s0">, </span><span class="s2">&quot;document_query&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">put(QueryType.NIR</span><span class="s0">, </span><span class="s2">&quot;nir_query&quot;</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">put(QueryType.RID</span><span class="s0">, </span><span class="s2">&quot;rid_query&quot;</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">}}</span><span class="s0">;</span>
        <span class="s1">tQueryTypeMap.forEach((key</span><span class="s0">, </span><span class="s1">value) -&gt; {</span>
            <span class="s1">parseQuerySection(key</span><span class="s0">, </span><span class="s1">value</span><span class="s0">, </span><span class="s1">mQueryTypeListElement)</span><span class="s0">;</span>
        <span class="s1">})</span><span class="s0">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>



















</pre>
</body>
</html>